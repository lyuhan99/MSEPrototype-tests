<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Pragma" name="Pragma" content="no-cache">
    <title>MSE Prototype</title>

    <!-- Bootstrap -->
    <base target="_top">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <!-- Bootstrap -->

    <!----Socket to send stuff to arduino --->
    <script src='https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.js'></script>

    <!-- Font Awesome -->
    <script src="https://use.fontawesome.com/098aba01d6.js"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css"
        integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
    <!-- Font Awesome -->




    <!---CSS-->
    <style>
        html,
        body {
            height: 100%;
        }

        body {
            position: relative;
            background-color: #3b3e42;
            /* background-image: url('img/Clue1.png'); */
            background-size: auto 100%;
            background-repeat: no-repeat;
            background-position: center;
        }

        .clue-image {
            position: absolute;
            top: 18vw;
            left: 25vw;
            width: 20vw;
            z-index: 1;

        }

        .clue-table {
            position: absolute;
            position: absolute;
            top: 25vw;
            left: 17.5vw;
            width: 35vw;
            height: 7vw;
            z-index: -1;
            background-color: rgb(99, 99, 99);
        }

        .control-knob {
            position: absolute;
            top: 12vw;
            left: 61vw;
        }

        .tap-dial {
            position: absolute;
            top: 12.5vw;
            left: 12vw;
            width: 1vw;
            height: 5vw;
            display: inline-block;
            transform-origin: top right;
            transform: rotate(90deg);
            z-index: 2;
        }

        .knob-image {
            position: absolute;
            width: 30vw;
        }

        .instruction-text {
            position: absolute;
            top: 43vw;
            left: 43vw;
        }

        .fire {
            position: absolute;
            top: 33vw;
            left: 22vw;
            z-index: 1;
        }

        .fire-image {
            width: 5vw;
            animation: growing 1300ms infinite;
        }

        .fire-image1 {
            position: absolute;
            left: 1vw;
        }

        .fire-image2 {
            position: absolute;
            left: 6vw;
        }

        .fire-image3 {
            position: absolute;
            left: 11vw;
        }

        .fire-image4 {
            position: absolute;
            left: 16vw;
        }

        .fire-image5 {
            position: absolute;
            left: 21vw;
        }

        @keyframes growing {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(1);
            }
        }

        .tap-animation-2000 {
            transform: rotate(270deg);
            transition: all 0.5s ease-in;
        }

        .tap-animation-1000 {
            transform: rotate(180deg);
            transition: all 0.5s ease-in;
        }

        .tap-animation-0 {
            transform: rotate(90deg);
            transition: all 0.5s ease-in;
        }

        .table-orange {
            transition: background-color 5s ease;
            background-color: rgb(209, 130, 84);
        }

        .table-red {
            transition: background-color 5s ease;
            background-color: rgb(228, 78, 52);
        }

        .table-grey {
            transition: background-color 5s ease;
            background-color: rgb(99, 99, 99);
        }

        .table-grey-fast {
            transition: background-color 0.5s ease;
            background-color: rgb(99, 99, 99);
        }

        .clue-melt {
            position: absolute;
            top: 24vw;
            left: 20vw;
            width: 30vw;
            z-index: 1;
        }

        .clue-half-melt {
            position: absolute;
            top: 22vw;
            left: 23vw;
            width: 25vw;
            z-index: 1;
        }

        .back-arrow {
            position: absolute;
            color: white;
            top: 3vw;
            left: 3vw;
        }
    </style>


</head>

<body>

    <div class="container relative">
        <div class="image-wrapper">
            <img class="clue-image" src="img/clue-normal.png">
            <img class="clue-half-melt" src="img/clue-halfmelted.png">
            <img class="clue-melt" src="img/clue-melted.png">
        </div>

        <div class="clue-table">

        </div>

        <div class="control-knob">
            <div class="bg-secondary tap-dial">
            </div>
            <img class="knob-image" src="img/heat-knob.jpg">
        </div>

        <div class="instruction-text row justify-content-center text-muted">
            Use the D and A keys to control the temperature.
        </div>

        <div class="fire">
            <img class="fire-image fire-image1" src="img/fire.png">
            <img class="fire-image fire-image2" src="img/fire.png">
            <img class="fire-image fire-image3" src="img/fire.png">
            <img class="fire-image fire-image4" src="img/fire.png">
            <img class="fire-image fire-image5" src="img/fire.png">
        </div>

        <i class="fa fa-arrow-left back-arrow fa-2x" aria-hidden="true"></i>


    </div>



    <!-- JavaScript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>


    <!-- Script -->

    <script type="text/javascript">
        $(document).ready(function () {

            var firstClueNo = window.localStorage.getItem("firstClue");

            //hide stuff
            $(".fire-image").hide();
            $(".clue-half-melt").hide();
            $(".clue-melt").hide();


            //temperature
            var temperature = 0;
            //to check to reset the setup
            var resetObject = false;

            //A metal - half melt at 1000, completely melt at 2000
            //B hydrophobic - melt at 1000
            //C ceramic - nothing happens
            //D hydrodynamic - melt at 1000

            var heatUpCount = 0;

            //sending and receiving data
            var socket = io();

            var messageReceived;

            socket.on('data', function (data) {
                console.log(data);
                //data is what is received
                messageReceived = data + "";
                if (messageReceived == "heat_up") {
                    console.log(heatUpCount);
                    heatUpCount++;
                    if (heatUpCount == 10) {
                        $(".tap-dial").removeClass("tap-animation-0")
                        $(".tap-dial").addClass("tap-animation-1000")
                        setTimeout(function () {
                            //show three fires
                            $(".fire-image2").fadeIn(3000);
                            $(".fire-image3").fadeIn(3000);
                            $(".fire-image4").fadeIn(3000);
                            setTimeout(function () {
                                $(".clue-table").removeClass("table-grey-fast")
                                $(".clue-table").removeClass("table-grey")
                                $(".clue-table").addClass("table-orange")
                                setTimeout(function () {
                                    if (resetObject == false) {
                                        if (firstClueNo == "A") {
                                            $(".clue-image").fadeOut(2000);
                                            $(".clue-half-melt").fadeIn(1000);
                                        } else if (firstClueNo == "B") {
                                            $(".clue-image").fadeOut(2000);
                                            $(".clue-melt").fadeIn(1000);
                                            resetObject = true;
                                            localStorage.setItem('firstClueHeatTest', true);
                                            setTimeout(function () {
                                                $(".instruction-text").text("Press [Enter] to start again.")
                                            }, 2500);
                                        } else if (firstClueNo == "D") {
                                            $(".clue-image").fadeOut(2000);
                                            $(".clue-melt").fadeIn(1000);
                                            resetObject = true;
                                            localStorage.setItem('firstClueHeatTest', true);
                                            setTimeout(function () {
                                                $(".instruction-text").text("Press [Enter] to start again.")
                                            }, 2500);
                                        }
                                    }
                                }, 2000);
                            }, 700);
                        }, 300);
                    } else if (heatUpCount == 20) {
                        $(".tap-dial").removeClass("tap-animation-1000")
                        $(".tap-dial").addClass("tap-animation-2000")
                        setTimeout(function () {
                            //show two more fires
                            $(".fire-image1").fadeIn(3000);
                            $(".fire-image5").fadeIn(3000);
                            setTimeout(function () {
                                $(".clue-table").removeClass("table-orange")
                                $(".clue-table").addClass("table-red")
                                setTimeout(function () {
                                    if (resetObject == false) {
                                        if (firstClueNo == "A") {
                                            $(".clue-half-melt").fadeOut(2000);
                                            $(".clue-melt").fadeIn(1000);
                                            resetObject = true;
                                            localStorage.setItem('firstClueHeatTest', true);
                                            setTimeout(function () {
                                                $(".instruction-text").text("Press [Enter] to start again.")
                                            }, 2500);
                                        } else if (firstClueNo == "C") {
                                            resetObject = true;
                                            localStorage.setItem('firstClueHeatTest', true);
                                            setTimeout(function () {
                                                $(".instruction-text").text("Press [Enter] to start again.")
                                            }, 2500);
                                        }
                                    }
                                }, 2000);
                            }, 700);
                        }, 300);
                    }
                } else if (messageReceived == "heat_down") {
                    console.log(heatUpCount);
                    heatUpCount--;
                    if (heatUpCount == 11) {
                        $(".tap-dial").removeClass("tap-animation-2000");
                        $(".tap-dial").addClass("tap-animation-1000");
                        setTimeout(function () {
                            //hide two fires
                            $(".fire-image1").fadeOut(3000);
                            $(".fire-image5").fadeOut(3000);
                            setTimeout(function () {
                                $(".clue-table").removeClass("table-red")
                                $(".clue-table").addClass("table-orange")
                            }, 700);
                        }, 300);
                    } else if (heatUpCount == 0) {
                        $(".tap-dial").removeClass("tap-animation-1000")
                        $(".tap-dial").addClass("tap-animation-0")
                        setTimeout(function () {
                            //hide all fires
                            $(".fire-image2").fadeOut(3000);
                            $(".fire-image3").fadeOut(3000);
                            $(".fire-image4").fadeOut(3000);
                            setTimeout(function () {
                                $(".clue-table").removeClass("table-orange")
                                $(".clue-table").addClass("table-grey")
                            }, 700);
                        }, 300);
                    }


                    // window.location.href = "test-selection-part1.html"

                }
            });

            document.addEventListener('keydown', function (event) {
                switch (event.key) {
                    case "d": //Enter key
                        // resetObject = false;
                        // console.log(temperature);
                        // if (temperature == 0) { //temperature becomes 1000 degrees
                        //     temperature = 1000
                        //     $(".tap-dial").removeClass("tap-animation-0")
                        //     $(".tap-dial").addClass("tap-animation-1000")
                        //     setTimeout(function () {
                        //         //show three fires
                        //         $(".fire-image2").fadeIn(3000);
                        //         $(".fire-image3").fadeIn(3000);
                        //         $(".fire-image4").fadeIn(3000);
                        //         setTimeout(function () {
                        //             $(".clue-table").removeClass("table-grey-fast")
                        //             $(".clue-table").removeClass("table-grey")
                        //             $(".clue-table").addClass("table-orange")
                        //             setTimeout(function () {
                        //                 if (resetObject == false) {
                        //                     if (firstClueNo == "A") {
                        //                         $(".clue-image").fadeOut(2000);
                        //                         $(".clue-half-melt").fadeIn(1000);
                        //                     } else if (firstClueNo == "B") {
                        //                         $(".clue-image").fadeOut(2000);
                        //                         $(".clue-melt").fadeIn(1000);
                        //                         resetObject = true;
                        //                         localStorage.setItem('firstClueHeatTest', true);
                        //                         setTimeout(function () {
                        //                             $(".instruction-text").text("Press [Enter] to start again.")
                        //                         }, 2500);
                        //                     } else if (firstClueNo == "D") {
                        //                         $(".clue-image").fadeOut(2000);
                        //                         $(".clue-melt").fadeIn(1000);
                        //                         resetObject = true;
                        //                         localStorage.setItem('firstClueHeatTest', true);
                        //                         setTimeout(function () {
                        //                             $(".instruction-text").text("Press [Enter] to start again.")
                        //                         }, 2500);
                        //                     }
                        //                 }
                        //             }, 2000);
                        //         }, 700);
                        //     }, 300);
                        // } else if (temperature == 1000) { //temperature becomes 2000 degrees
                        //     temperature = 2000
                        //     $(".tap-dial").removeClass("tap-animation-1000")
                        //     $(".tap-dial").addClass("tap-animation-2000")
                        //     setTimeout(function () {
                        //         //show two more fires
                        //         $(".fire-image1").fadeIn(3000);
                        //         $(".fire-image5").fadeIn(3000);
                        //         setTimeout(function () {
                        //             $(".clue-table").removeClass("table-orange")
                        //             $(".clue-table").addClass("table-red")
                        //             setTimeout(function () {
                        //                 if (resetObject == false) {
                        //                     if (firstClueNo == "A") {
                        //                         $(".clue-half-melt").fadeOut(2000);
                        //                         $(".clue-melt").fadeIn(1000);
                        //                         resetObject = true;
                        //                         localStorage.setItem('firstClueHeatTest', true);
                        //                         setTimeout(function () {
                        //                             $(".instruction-text").text("Press [Enter] to start again.")
                        //                         }, 2500);
                        //                     } else if (firstClueNo == "C") {
                        //                         resetObject = true;
                        //                         localStorage.setItem('firstClueHeatTest', true);
                        //                         setTimeout(function () {
                        //                             $(".instruction-text").text("Press [Enter] to start again.")
                        //                         }, 2500);
                        //                     }
                        //                 }
                        //             }, 2000);
                        //         }, 700);
                        //     }, 300);
                        // } else {

                        // }
                        break;
                    case "a":
                        // if (temperature == 2000) { //temperature becomes 1000 degrees
                        //     temperature = 1000;
                        //     $(".tap-dial").removeClass("tap-animation-2000");
                        //     $(".tap-dial").addClass("tap-animation-1000");
                        //     setTimeout(function () {
                        //         //hide two fires
                        //         $(".fire-image1").fadeOut(3000);
                        //         $(".fire-image5").fadeOut(3000);
                        //         setTimeout(function () {
                        //             $(".clue-table").removeClass("table-red")
                        //             $(".clue-table").addClass("table-orange")
                        //         }, 700);
                        //     }, 300);
                        // } else if (temperature == 1000) { //temperature becomes 0 degrees
                        //     temperature = 0
                        //     $(".tap-dial").removeClass("tap-animation-1000")
                        //     $(".tap-dial").addClass("tap-animation-0")
                        //     setTimeout(function () {
                        //         //hide all fires
                        //         $(".fire-image2").fadeOut(3000);
                        //         $(".fire-image3").fadeOut(3000);
                        //         $(".fire-image4").fadeOut(3000);
                        //         setTimeout(function () {
                        //             $(".clue-table").removeClass("table-orange")
                        //             $(".clue-table").addClass("table-grey")
                        //         }, 700);
                        //     }, 300);
                        // } else {

                        // }
                        break;
                    case "Enter":
                        // if (resetObject) {
                        //     $(".tap-dial").removeClass("tap-animation-1000")
                        //     $(".tap-dial").addClass("tap-animation-0")
                        //     $(".clue-table").removeClass("table-orange")
                        //     $(".clue-table").addClass("table-grey-fast")
                        //     $(".clue-melt").fadeOut();
                        //     $(".clue-image").fadeIn();
                        //     $(".fire-image").fadeOut();
                        //     $(".instruction-text").text("Use the D and A keys to control the temperature.")
                        //     temperature = 0;
                        // }
                        break;
                    case "ArrowLeft":
                        window.location.href = "test-selection-part1.html"
                        break;
                    default:
                        return;
                }
            });





        });

    </script>

</body>

</html>